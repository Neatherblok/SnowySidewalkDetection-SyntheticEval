# **Synthetic Snowy Sidewalk Image Generation and Evaluation**

## **Overview**
This project explores the potential of **prompt-based synthetic image generators** in producing realistic snowy sidewalk images for training **machine learning models for snow detection**. By leveraging **synthetic datasets generated by OpenAI’s DALL·E 3 and xAI’s Grok 2**, we compare their effectiveness against real-world datasets for training a **sidewalk snow classification model**.

The synthetic images are **evaluated using a pre-trained sidewalk snow detection network**, assessing their similarity to real-world data in classification accuracy.

## **Prompt for Synthetic Image Generation**
To ensure consistency, the following prompt was used to generate **250 images of snowy sidewalks** and **250 images of clear sidewalks** from each model:

```
Generate a realistic winter scene from a first-person pedestrian perspective, looking down at a cracked concrete sidewalk. The sidewalk is partially covered with icy, slushy snow, concentrated along the edges where snow transitions into ice. Footprints are visible in the icy patches. The left side of the image shows accumulated snow with small patches of brown grass peeking through. The lighting is natural, with soft daylight, capturing the texture of the snow, ice, and sidewalk in a cold, wintry outdoor setting.
```

For **clear sidewalk images**, a modified prompt was used:

```
Generate a realistic outdoor scene from a pedestrian's perspective looking down at a clean, cracked concrete sidewalk on a clear day. The sidewalk is bordered by a patch of dry grass and a landscaped area with mulch, dormant shrubs, and a large rock. Pink stakes are visible marking parts of the landscaped area. The lighting is natural and sunny, casting soft shadows and highlighting the textures of the sidewalk, grass, and surroundings. The scene captures a calm, real-world outdoor setting without including any visible objects like a smartphone.
```

These prompts were designed by **OpenAI’s ChatGPT-4o**, after analyzing real-world sidewalk images from a dataset created by **de Deijn & Bukralia (2024)**.

## **Evaluation Methodology**
The generated synthetic images are tested against a **pre-trained sidewalk snow detection network** developed by **de Deijn (2024)**.

### **Model Training & Testing**
- **Datasets Used for Training:**
  - **Real-world dataset** (500 images: 250 snowy, 250 clear sidewalks)
  - **Synthetic dataset (DALL·E 3)** (500 images)
  - **Synthetic dataset (Grok 2)** (500 images)

- **Test Set:**
  - 118 images (59 snowy, 59 clear sidewalks) collected from real-world locations.

- **Evaluation Metrics:**
  - **F2 Score**: Prioritizes recall over precision to emphasize accurate snow detection.
  - **Confusion Matrix Analysis**: Assesses differences in detection capabilities across datasets.

## **Project Structure**
```
Synthetic-Snowy-Sidewalk/
│── collect_images/           # Scripts for downloading synthetic images
│── evaluation/               # Model evaluation scripts (F2 score, confusion matrices)
│── trained_models/           # Directory where trained models are saved
│── main.py                   # Main script for training and evaluation
│── requirements.txt          # Dependencies for the project
│── README.md                 # Project documentation
```

## **Installation**
### **1. Clone the Repository**
```bash
git clone https://github.com/yourusername/Synthetic-Snowy-Sidewalk.git
cd Synthetic-Snowy-Sidewalk
```

### **2. Install Dependencies**
```bash
pip install -r requirements.txt
```

## **Usage**

### **1. Train Models**

Train the model using:

```bash
python main.py train --epochs 25 --batch-size 4 --learning-rate 0.001 -v
```

#### **Optional Arguments:**
- `--epochs` *(int)*: Number of epochs (default = 25)
- `--batch-size` *(int)*: Batch size for training (default = 4)
- `--learning-rate` *(float)*: Learning rate (default = 0.001)
- `-v, --verbose`: Enables verbose output during training.

### **2. Evaluate Trained Models**

Run the following command to evaluate trained models:

```bash
python main.py eval --runs 12 -v
```

#### **Optional Arguments:**
- `--runs` *(int)*: Number of evaluation rounds (default = 12)
- `--models` *(list)*: Specify particular models to evaluate (e.g., `DALL-E_3`, `Grok_2`, `real-world`)

## **Results Summary**

### **F2 Scores Comparison**
| Model       | Avg. F2 Score |
|------------|--------------|
| DALL·E 3   | **82.25%**   |
| Grok 2     | **94.23%**   |
| Real-World | **89.50%**   |

### **Key Insights:**
- **Grok 2 outperforms both DALL·E 3 and real-world data**, achieving the highest F2 score.
- **Real-world data exhibits stronger accuracy in detecting clear sidewalks**, leading to fewer overall misclassifications.
- **DALL·E 3 lags behind**, likely due to lower photorealism and lack of fine-grained detail in synthetic snow representation.

## **Acknowledgments**
This project was conducted as part of research at **Minnesota State University, Mankato** by **Ricardo de Deijn and Rajeev Bukralia**.

## **License**
This project is licensed under the **MIT License**.

## **Contact**
For questions or suggestions, please open an issue or contact:  
📩 **[ricardodedeijn@gmail.com](mailto:ricardodedeijn@gmail.com)**
